weekly_meal_evaluation_prompt = """
作为一位严格的营养评估专家，请对以下7天食谱进行全面评估，重点关注食材安全和完整性：

用户信息：
{user_info}

健康目标：
{analysis_result}

7天食谱：
{weekly_meal_plan}

## 评估步骤（按优先级排序）
1. 【禁用食材检查】（最高优先级）
   - 严格检查是否使用了任何禁忌/过敏食材
   - 标记任何可能存在交叉污染风险的食材

2. 【完整性检查】（第二优先级）
   - 确认是否包含完整的7天21餐
   - 检查每餐是否有完整的菜品构成

3. 【营养均衡评估】
   - 7天内营养素的均衡性
   - 各餐营养分配的合理性
   - 是否满足用户的特定营养需求

4. 【健康目标匹配度】
   - 是否符合用户的健康状况和目标
   - 是否有助于改善用户的具体问题

5. 【实用性评估】
   - 食材搭配的合理性
   - 烹饪方式的可行性
   - 是否符合用户的饮食习惯

输出格式：
{{
  "overall_score": 0-100的整数评分,
  "general_comments": "总体评价，重点说明禁用食材和完整性问题",
  "improvement_suggestions": [
    {{
      "day": 第几天(编号1.2...7),//注意这里直接输出单个整数
      "meal": "早餐/午餐/晚餐",
      "issue": "问题描述",
      "suggestion": "改进建议"
    }},
    ...
  ]
}}
## 评分标准
- 发现禁用食材：直接扣50分
- 餐食不完整：每缺一餐扣5分
- 营养不均衡：最多扣30分
- 不符合健康目标：最多扣15分

## 注意事项
1. 必须严格检查禁用食材
2. 必须确保7天21餐的完整性
3. day必须是1-7中的单个整数
4. meal只能是早餐/午餐/晚餐之一
5. JSON格式必须完全正确
##请确保JSON格式正确并只返回{{}}内的正文内容，day必须是1-7中的单个整数，meal只能是早餐/午餐/晚餐之一，不要添加任何额外的文本或解释。
"""

follow_up_evaluation_prompt = """
作为一位严格的营养评估专家，请评估修改后的食谱是否解决了所有问题，特别是禁用食材和完整性问题：

用户信息：
{user_info}

分析结果：
{analysis_result}

修改后的食谱：
{weekly_meal_plan}

之前的评估历史：
{evaluation_history}

## 评估重点
1. 【禁用食材复查】
   - 确认之前发现的禁用食材是否已完全移除
   - 检查新修改的餐食是否引入了新的禁用食材

2. 【完整性复查】
   - 确认之前缺失的餐食是否已补充
   - 检查修改过程是否导致新的缺失

3. 【改进效果评估】
   - 评估修改是否解决了原有问题
   - 确认修改是否引入了新问题

输出格式：
{{
  "overall_score": 0-100的整数评分,
  "general_comments": "总体评价，重点说明问题解决情况",
  "improvement_suggestions": [
    {{
      "day": 第几天(编号1.2...7),//注意这里直接输出单个整数
      "meal": "早餐/午餐/晚餐",
      "issue": "问题描述",
      "suggestion": "改进建议"
    }},
    ...
  ],
  "evaluation_complete": true/false
}}
如果所有问题都已解决，没有新的问题，请将 "evaluation_complete" 设置为 true。否则设置为 false。
## 完成条件
evaluation_complete 设置为 true 需满足：
1. 没有任何禁用食材
2. 7天21餐完整
3. 没有严重的营养问题
4. 整体评分达到85分以上

## 注意事项
1. 禁用食材问题必须完全解决
2. 必须确保7天21餐的完整性
3. day必须是1-7中的单个整数
4.  meal只能是早餐/午餐/晚餐之一
5. JSON格式必须完全正确
##请确保JSON格式正确并只返回{{}}内的正文内容，day必须是1-7中的单个整数，meal只能是breakfast/lunch/dinner之一，不要添加任何额外的文本或解释。
"""
